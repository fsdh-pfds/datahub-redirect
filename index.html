<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Redirecting…</title>

    <!-- Load Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-87JM90X2QF"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-87JM90X2QF");
    </script>

    <!-- On load: grab utm_*, fire GA, then redirect -->
    <script>
      window.addEventListener("load", () => {
        const params = new URLSearchParams(location.search);
        const dest = params.get("redirect-url");
        if (!dest) {
          document.body.innerHTML =
            '<p style="color:red">Error: missing “redirect-url” parameter.</p>';
          return;
        }

        // collect any utm_* fields
        const campaignFields = {};
        ["source", "medium", "campaign", "term", "content"].forEach((key) => {
          const v = params.get("utm_" + key);
          if (v) campaignFields["campaign_" + key] = v;
        });

        // fire GA with campaign override + record this page/view
        gtag(
          "config",
          "G-87JM90X2QF",
          Object.assign(
            {
              page_path: location.pathname + location.search,
            },
            campaignFields
          )
        );

        // brief pause to let GA send the hit
        setTimeout(() => {
          window.location.replace(dest);
        }, 100);
      });
    </script>

    <style>
      body {
        font-family: sans-serif;
        text-align: center;
        margin-top: 20vh;
        color: #444;
      }
    </style>
  </head>
  <body>
    <p>Hold on – redirecting you now…</p>
  </body>
</html>
